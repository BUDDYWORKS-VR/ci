<section class="animate">
  <h2 class="text-2xl font-bold text-black dark:text-white mb-6">Colors</h2>
  <p class="mb-8">
    Our standardized palette used for all brand assets. Click a color to copy
    its hex code.
  </p>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    {[
      {
        label: "Accent A",
        hex: "#FDDA0D",
        name: "Cadmium Yellow",
        text: "text-black",
      },
      {
        label: "Accent B",
        hex: "#e5e5e5",
        name: "Glowing-Hairstrain White",
        text: "text-black",
      },
      {
        label: "Stencil A",
        hex: "#000000",
        name: "Plain Black",
        text: "text-white",
      },
      {
        label: "Stencil B",
        hex: "#191919",
        name: "Dark Grey",
        text: "text-white",
      },
    ].map((color) => (
      <button
        class="color-card group flex w-full items-center rounded-lg border border-black/10 bg-black/5 p-4 text-left transition-colors hover:bg-black/10 dark:border-white/10 dark:bg-white/5 dark:hover:bg-white/10"
        data-hex={color.hex}
        aria-label={`Copy ${color.name} hex code`}
      >
        <div
          class={`color-swatch flex size-16 items-center justify-center rounded-md font-mono text-xs shadow-sm transition-transform active:scale-95 ${color.text}`}
          style={`background-color: ${color.hex}`}
        >
          {color.hex}
        </div>
        <div class="ml-4">
          <div class="text-sm font-semibold text-black dark:text-white">
            {color.label}
          </div>
          <div class="color-name text-sm opacity-70">{color.name}</div>
        </div>
      </button>
    ))}
  </div>
</section>

<script>
  function initColorCopy() {
    const cards = document.querySelectorAll(".color-card");

    cards.forEach((card) => {
      card.addEventListener("click", async () => {
        const hex = card.getAttribute("data-hex");
        const nameLabel = card.querySelector(".color-name");

        // Null check to satisfy TypeScript
        if (!hex || !nameLabel) return;

        const originalText = nameLabel.textContent || "";

        await navigator.clipboard.writeText(hex);

        // Visual feedback
        nameLabel.textContent = "Copied!";
        nameLabel.classList.add("text-[#FDDA0D]", "font-bold");

        setTimeout(() => {
          nameLabel.textContent = originalText;
          nameLabel.classList.remove("text-[#FDDA0D]", "font-bold");
        }, 1500);
      });
    });
  }

  // Initialize on page load and after Astro transitions
  document.addEventListener("DOMContentLoaded", initColorCopy);
  document.addEventListener("astro:after-swap", initColorCopy);
</script>